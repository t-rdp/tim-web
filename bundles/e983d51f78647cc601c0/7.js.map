{"version":3,"sources":["webpack:///./node_modules/matrix-react-sdk/src/async-components/views/dialogs/security/ExportE2eKeysDialog.tsx","webpack:///./node_modules/matrix-react-sdk/src/utils/MegolmExportEncryption.ts"],"names":["Phase","ExportE2eKeysDialog","React","Component","constructor","props","super","ev","preventDefault","passphrase","this","state","passphrase1","passphrase2","setState","errStr","_t","startExport","onFinished","phrase","target","value","phase","Edit","componentWillUnmount","unmounted","Promise","resolve","then","matrixClient","exportRoomKeys","k","MegolmExportEncryption","JSON","stringify","f","blob","Blob","type","FileSaver","saveAs","catch","e","logger","error","msg","friendlyText","Exporting","render","disableForm","className","title","onSubmit","onPassphraseFormSubmit","label","onChange","onPassphraseChange","autoFocus","size","disabled","onClick","onCancelClick","subtleCrypto","window","crypto","subtle","webkitSubtle","friendlyError","message","cryptoFailMsg","async","decryptMegolmKeyFile","data","password","body","fileStr","TextDecoder","decode","Uint8Array","lineStart","lineEnd","indexOf","Error","line","slice","trim","HEADER_LINE","dataStart","undefined","TRAILER_LINE","dataEnd","base64","latin1String","atob","uint8Array","length","i","charCodeAt","decodeBase64","unpackMegolmKeyFile","brand","SdkConfig","get","ciphertextLength","salt","subarray","iv","iterations","ciphertext","hmac","aesKey","hmacKey","deriveKeys","toVerify","isValid","plaintext","verify","name","decrypt","counter","encryptMegolmKeyFile","options","kdfRounds","kdf_rounds","getRandomValues","encodedData","TextEncoder","encode","encrypt","cipherArray","bodyLength","resultBuffer","idx","set","toSign","sign","hmacArray","LINE_LENGTH","nLines","Math","ceil","lines","Array","o","encodeBase64","join","buffer","packMegolmKeyFile","start","Date","key","keybits","importKey","deriveBits","hash","now","log","getTime","aesProm","hmacProm","all","String","fromCharCode","apply","from","btoa"],"mappings":"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","file":"bundles/e983d51f78647cc601c0/7.js","sourceRoot":""}